<!doctype html>
<html lang="en" data-bs-theme="auto">
<head>
    <script type="text/javascript">
        window.invert_report = window.invert_report || {};

        window.keysForObject = function (obj) {
            let newKeys = []
            let keys = obj.keys()
            let nextKey = keys.next();
            while (!nextKey.done) {
                newKeys.push(nextKey.value)
                nextKey = keys.next();
            }
            return newKeys
        }

        let DEBUG_LOGGING = false

        window.loadJsFileAsync = function (url, notifyCompleteCallback) {
            let s = document.createElement('script');
            s.setAttribute('src', url);
            s.onload = function () {
                notifyCompleteCallback()
            };
            document.body.appendChild(s);
        }

        window.externalLoadJavaScriptFile = function (key, callback) {
            let src = "js/" + key + ".js"
            const start = Date.now();
            loadJsFileAsync(src, function () {
                let json = JSON.stringify(window.invert_report[key])
                if (DEBUG_LOGGING) {
                    const end = Date.now();
                    console.log(`${end - start}ms *** Finished JSON Stringify ${key}`);
                }
                callback(json)
            })
        }
    </script>

    <style>
        [data-bs-theme="dark"] img.bootstrap-icon {
            filter: invert(100);
        }
    </style>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>Custom Report</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

    <!-- Favicons -->
    <meta name="theme-color" content="#712cf9">

    <!-- Custom styles for this template -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <style>
        @media (min-width: 768px) {
            .sidebar .offcanvas-lg {
                position: -webkit-sticky;
                position: sticky;
                top: 48px;
            }
        }

        .sidebar .nav-link {
            font-size: .875rem;
            font-weight: 500;
            text-align: left;
        }

        .sidebar-heading {
            font-size: .75rem;
        }

        .navbar-brand {
            padding-top: .75rem;
            padding-bottom: .75rem;
        }

    </style>
</head>
<body>

<header class="navbar sticky-top bg-dark flex-md-nowrap p-0 shadow" data-bs-theme="dark">
    <a class="navbar-brand col-md-3 me-0 px-3 fs-6 text-white" href="#">Android Foundation Reports</a>
    <!-- Loading Progress Renders Here -->
    <div id="navbar_content" class="navbar-text pe-4 col-md-9 text-end">
    </div>
</header>

<div class="row">
    <div class="col-lg-2 p-0">
        <div class="sidebar border border-right bg-body-tertiary">
            <div class="d-flex flex-column p-3 bg-body-tertiary">
                <ul class="nav nav-pills flex-column mb-auto" id="navigation">
                </ul>
            </div>
        </div>
    </div>

    <main class="col-lg-10">
        <div id="main_content" class="p-3">
        </div>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

<script type="text/javascript">
    // https://github.com/vasturiano/force-graph
    // https://unpkg.com/force-graph
    window.render3dGraph = function (domElementId, graphDataJson, width, height) {
        if(window.ForceGraph == undefined) {
            loadJsFileAsync("https://unpkg.com/force-graph", function (obj) {
                const graphData = JSON.parse(graphDataJson)
                const Graph = ForceGraph()
                (document.getElementById(domElementId))
                .graphData(graphData)
                .nodeId('id')
                .nodeAutoColorBy('group')
                .dagMode('rl')
                .width(width)
                .height(height)
                .nodeCanvasObject((node, ctx, globalScale) => {
                    const label = node.id;
                    const fontSize = 12 / globalScale;
                    ctx.font = `${fontSize}px Sans-Serif`;
                    const textWidth = ctx.measureText(label).width;
                    const bckgDimensions = [textWidth, fontSize].map(n => n + fontSize * 0.2);

                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.fillRect(node.x - bckgDimensions[0] / 2, node.y - bckgDimensions[1] / 2, ...bckgDimensions);

                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillStyle = node.color;
                    ctx.fillText(label, node.x, node.y);

                    node.__bckgDimensions = bckgDimensions;
                })
                .onNodeClick(node => {
                    Graph.centerAt(node.x, node.y, 1000);
                    Graph.zoom(8, 2000);
                })
                .nodePointerAreaPaint((node, color, ctx) => {
                    ctx.fillStyle = color;
                    const bckgDimensions = node.__bckgDimensions;
                    bckgDimensions && ctx.fillRect(node.x - bckgDimensions[0] / 2, node.y - bckgDimensions[1] / 2, ...bckgDimensions);
                });
            });
        }
    }
</script>
<script src="invert_web.js"></script>
</body>
</html>
